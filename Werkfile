let werk-vscode-version = shell "jq --raw-output .version werk-vscode/package.json" 

build "/werk-vscode/werk-{werk-vscode-version}.vsix" {
    from glob "werk-vscode/**/*"
    run "npm --prefix werk-vscode run package -- --out ../target/werk-vscode"
}
build "/book/book" {
    run "mdbook build book --dest-dir book/book"
}

task vscode-install-extension {
    let vsix = "/werk-vscode/werk-{werk-vscode-version}.vsix"
    build vsix
    run "code --install-extension <vsix>"
}

task cli-install {
    run "cargo install --path werk-cli"
}

task mdbook-serve {
    run "mdbook serve book"
}